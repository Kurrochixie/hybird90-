rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Allow read access to anyone for any file.
    // This is common for public assets like profile pictures.
    match /{allPaths=**} {
      allow read;
    }

    // Rules for user profile pictures
    // Path matches the one in profile_page.dart: /user_profiles/{userId}.jpg
    match /user_profiles/{userId} {
      // Allow a user to write (create, update, delete) to their own profile picture file.
      // This rule ensures the user's ID in the path matches the authenticated user's ID.
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
